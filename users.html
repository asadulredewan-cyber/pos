<!DOCTYPE html>
<html lang="bn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User & Management</title>

    <link rel="stylesheet" href="assets/css/users.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>

    <div id="app-layout" class="app-container"></div>

    <div id="main-content-body" style="display: none;">

        <div class="main-user-wrapper">

            <div id="profileView" class="section-container">
                <h2 class="section-title">আমার প্রোফাইল ও সেটিংস</h2>

                <div class="profile-grid">

                    <div class="profile-card info-section">
                        <div class="profile-header">
                            <div class="profile-img-wrap">
                                <div id="profileImagePreview" class="profile-image"></div>
                                <input type="file" id="imageUploadInput" accept="image/*" style="display:none;">
                                <button id="uploadBtn" class="upload-btn" title="ছবি পরিবর্তন"><i
                                        class="fas fa-camera"></i></button>
                            </div>
                            <h3 id="profileNameDisplay">Loading...</h3>
                            <p class="role-badge" id="profileRoleDisplay">...</p>
                        </div>

                        <div class="profile-details">
                            <h4>ব্যক্তিগত তথ্য</h4>
                            <p><strong>ইমেইল:</strong> <span id="profileEmail"></span></p>
                            <p><strong>ফোন:</strong> <span id="profilePhone"></span></p>
                            <p><strong>রোল:</strong> <span id="profileRoleDetail"></span></p>
                            <p><strong>অ্যাক্সেসড শপ:</strong> <span id="profileShops"></span></p>
                        </div>

                        <button class="btn-primary full-width" style="margin-top: 20px;" onclick="openPasswordModal()">
                            <i class="fas fa-lock"></i> পাসওয়ার্ড পরিবর্তন করুন
                        </button>

                    </div>
                </div>
            </div>

            <div id="managementView" class="section-container" style="display: none; margin-top: 40px;">
                <h2 class="section-title">অ্যাডমিন ম্যানেজমেন্ট প্যানেল</h2>

                <div class="management-tabs">
                    <button id="tabEmployee" class="tab-btn active" onclick="switchManagementTab('employee')">
                        <i class="fas fa-users"></i> এমপ্লয়ি ম্যানেজমেন্ট
                    </button>
                    <button id="tabShops" class="tab-btn" onclick="switchManagementTab('shops')">
                        <i class="fas fa-store"></i> শপ ম্যানেজমেন্ট
                    </button>
                </div>

                <div id="employeeTab" class="tab-content active">
                    <div class="u-header">
                        <div class="u-search">
                         
                        </div>
                        <button class="btn-add" onclick="openUserModal()"><i class="fas fa-user-plus"></i> নতুন ইউজার
                            যোগ করুন</button>
                    </div>
                    <div class="u-table-wrap">
                        <table class="u-table">
                            <thead>
                                <tr>
                                    <th>নাম & রোল</th>
                                    <th>যোগাযোগ</th>
                                    <th>দোকান অ্যাক্সেস</th>
                                    <th>অ্যাকশন</th>
                                </tr>
                            </thead>
                            <tbody id="employeeTableBody">
                                <tr>
                                    <td colspan="4">লোডিং এমপ্লয়ি ডাটা...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="shopsTab" class="tab-content">
                    <div class="u-header">
                        <div class="u-search">
                            
                            
                        </div>
                        <button class="btn-add" onclick="openShopModal()"><i class="fas fa-plus"></i> নতুন দোকান যোগ
                            করুন</button>
                    </div>
                    <div class="u-table-wrap">
                        <table class="u-table">
                            <thead>
                                <tr>
                                    <th>দোকানের নাম</th>
                                    <th>মোট এমপ্লয়ি</th>

                                    <th>অ্যাকশন</th>
                                </tr>
                            </thead>
                            <tbody id="shopTableBody">
                                <tr>
                                    <td colspan="4">লোডিং শপ ডাটা...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
        </div>
    </div>


    <div id="passwordModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closePasswordModal()">&times;</span>
            <h3 id="passwordModalTitle">পাসওয়ার্ড পরিবর্তন</h3>
            <form id="passwordChangeForm">
                <p id="passwordWarning" style="color:red; font-size:12px; margin-bottom: 15px;">
                    পাসওয়ার্ড পরিবর্তন করতে বর্তমান পাসওয়ার্ড প্রয়োজন।
                </p>
                <div class="form-group">
                    <label>বর্তমান পাসওয়ার্ড</label>
                    <input type="password" id="oldPassword" required>
                </div>
                <div class="form-group">
                    <label>নতুন পাসওয়ার্ড</label>
                    <input type="password" id="newPassword" required minlength="6">
                </div>
                <div class="form-group">
                    <label>নতুন পাসওয়ার্ড নিশ্চিত করুন</label>
                    <input type="password" id="confirmPassword" required minlength="6">
                </div>
                <button type="submit" class="btn-save">পাসওয়ার্ড আপডেট করুন</button>
                <p id="passwordStatus" style="margin-top:10px;"></p>
            </form>
        </div>
    </div>


    <div id="userModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeUserModal()">&times;</span>
            <h3 id="userModalTitle">ইউজার তথ্য দিন</h3>

            <form id="userForm">
                <input type="hidden" id="editUserId">

                <div class="form-group"><label>নাম <span style="color:red">*</span></label><input type="text" id="uName"
                        required></div>
                <div class="form-group"><label>ফোন (ঐচ্ছিক)</label><input type="text" id="uPhone"></div>
                <div class="form-group"><label>ইমেইল <span style="color:red">*</span></label><input type="email"
                        id="uEmail" required></div>

                <div class="form-group" id="userRoleShopGroup">
                    <div class="form-row">
                        <div class="form-group">
                            <label>রোল (Role) <span style="color:red">*</span></label>
                            <select id="uRole" required>
                                <option value="seller">Seller</option>
                                <option value="manager">Manager</option>
                                <option value="admin">Admin</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>দোকান অ্যাক্সেস <span style="color:red">*</span></label>
                            <select id="uShopsSelect" required multiple size="3"></select>
                            <small style="color:#666; font-size:11px;">Ctrl/Cmd চেপে একাধিক দোকান সিলেক্ট করুন।</small>
                        </div>
                    </div>
                </div>

                <div class="form-group" id="passwordGroup">
                    <label>পাসওয়ার্ড <span style="color:red">*</span></label>
                    <input type="password" id="uPassword" placeholder="কমপক্ষে ৬ ক্যারেক্টার">
                    <small style="color:#666; font-size:11px; display:none;" id="passwordHint">
                        আপডেট করার সময় ফাঁকা রাখলে পরিবর্তন হবে না।
                    </small>
                </div>

                <button type="submit" class="btn-save">সংরক্ষণ করুন</button>
            </form>
        </div>
    </div>

    <div id="shopModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeShopModal()">&times;</span>
            <h3 id="shopModalTitle">
                <i class="fas fa-plus-circle"></i> নতুন দোকান যোগ করুন
            </h3>
            <form id="shopForm">
                <input type="hidden" id="editShopId">
                <div class="form-group">
                    <label>দোকানের নাম <span style="color:red">*</span></label>
                    <input type="text" id="sShopId" required placeholder="e.g., Shop-A, Gulshan-Branch">
                </div>
                <button type="submit" class="btn-save">সংরক্ষণ করুন</button>
            </form>
        </div>
    </div>


    <script type="module" src="firebase/config.js"></script>
    <script type="module" src="assets/js/layout.js"></script>
    <script type="module" src="assets/js/users.js"></script>

</body>

</html>